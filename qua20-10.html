<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>üíñ M√≥n qu√† 20/10 üíê</title>
<link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@700&family=Quicksand:wght@400;700&display=swap" rel="stylesheet">
<style>
/* PH·∫¶N ƒê√É S·ª¨A: B·ªî SUNG TRANSITION CHO BODY */
body {
    margin: 0;
    padding: 0;
    height: 100vh;
    display: flex;
    justify-content: center;
    align-items: center;
    flex-direction: column;
    background: linear-gradient(135deg, #fce4ec 0%, #f8bbd0 100%);
    font-family: 'Quicksand', sans-serif;
    text-align: center;
    overflow: hidden;
    position: relative;
    perspective: 1000px;
    
    /* M·ªöI: Th√™m Transition cho hi·ªáu ·ª©ng Fade-in */
    transition: opacity 700ms ease-in, transform 700ms ease-in; 
    /* M·ªöI: Tr·∫°ng th√°i ban ƒë·∫ßu (·∫©n) */
    opacity: 0;
    transform: scale(0.95);
}
/* M·ªöI: L·ªõp ƒë·ªÉ k√≠ch ho·∫°t Fade-in khi JS ch·∫°y */
body.fade-in {
    opacity: 1;
    transform: scale(1);
}
/* K·∫æT TH√öC PH·∫¶N S·ª¨A */

/* --- INPUT & BUTTON --- */
#name-input-container {
    margin-bottom: 20px;
    display: flex; 
    flex-direction: column;
    align-items: center;
    justify-content: center;
    transition: opacity 0.5s ease-out, transform 0.5s ease-out; 
    opacity: 1;
    transform: translateY(0);
}

/* CSS M·ªöI: Hi·ªáu ·ª©ng l√†m m·ªù v√† tr∆∞·ª£t l√™n cho ph·∫ßn nh·∫≠p t√™n */
#name-input-container.fade-out-name {
    opacity: 0;
    transform: translateY(-20px);
}

/* Wrapper cho Input */
#input-wrapper {
    display: flex;
    align-items: center;
    margin-bottom: 15px;
}

/* Th√™m ki·ªÉu cho input v√† button cho ƒë·∫πp h∆°n */
#name-input-container input, #name-input-container button {
    padding: 10px 15px;
    border-radius: 25px;
    border: 2px solid #ff69b4;
    font-size: 16px;
    font-family: 'Quicksand', sans-serif;
    box-shadow: 0 4px 6px rgba(0,0,0,0.1);
    transition: all 0.3s ease;
}

#name-input-container input {
    width: 200px;
}

#name-input-container button {
    background-color: #ff69b4;
    color: white;
    cursor: pointer;
    font-weight: 700;
    width: 200px;
}

#name-input-container button:hover {
    background-color: #ff1493;
    transform: translateY(-2px);
    box-shadow: 0 6px 10px rgba(0,0,0,0.15);
}

#note {
    color: #880e4f;
    font-size: 20px;
    font-weight: 700;
    margin-top: 25px;
    animation: glowText 2.5s ease-in-out infinite alternate;
    text-shadow: 0 0 6px rgba(255,182,193,0.7);
}

@keyframes glowText {
    from {opacity:0.7; transform:scale(1);}
    to {opacity:1; transform:scale(1.02);}
}

#gift-box {
    width: 300px;
    cursor: pointer;
    transition: transform 0.5s ease, box-shadow 0.5s ease, opacity 0.7s ease-in-out, transform 0.7s ease-in-out; 
    animation: none;
    opacity: 0;
    transform: scale(0.8);
    z-index: 5;
    box-shadow: 0 10px 15px rgba(0,0,0,0.2);
    border-radius: 10px;
    will-change: transform;
    display: none;
}

/* CSS M·ªöI: Hi·ªáu ·ª©ng l√†m hi·ªán v√† ph√≥ng to cho h·ªôp qu√† */
#gift-box.fade-in-gift {
    opacity: 1;
    transform: scale(1);
    animation: pulse 2s infinite ease-in-out;
}

#gift-box:hover {
    transform: scale(1.05);
    box-shadow: 0 12px 25px rgba(255,105,180,0.5);
}

@keyframes pulse {
    0% {transform:scale(1);}
    50% {transform:scale(1.05);}
    100% {transform:scale(1);}
}

.fade-out { animation: fadeOut 1s forwards; }
@keyframes fadeOut {
    from {opacity:1; transform:scale(1);}
    to {opacity:0; transform:scale(0.7);}
}

/* --- CARD --- */
#card {
    display: none;
    background: #fffcf8;
    border-radius: 25px;
    border: 12px solid #fce4ec;
    box-shadow: 0 0 25px rgba(255,105,180,0.4);
    padding: 50px;
    width: 85%;
    max-width: 650px;
    text-align: center;
    opacity: 0;
    transform: scale(0.8);
    position: relative;
    overflow: hidden;
    will-change: transform, opacity;
    background-image: radial-gradient(#ffebee 10%, transparent 10%),
                      radial-gradient(#ffcdd2 10%, transparent 10%);
    background-size: 20px 20px;
    background-position: 0 0, 10px 10px;
}

#card::before {
    content:'';
    position:absolute;
    top:20px; left:20px; right:20px; bottom:20px;
    border:2px dashed #ff99b3;
    border-radius:10px;
    pointer-events:none;
    z-index:1;
}

@keyframes cardSlideIn {
    0% {transform:translateY(30vh) scale(0.8); opacity:0;}
    100% {transform:translateY(0) scale(1); opacity:1;}
}

#card.show {
    display: block;
    animation: cardSlideIn 1.2s cubic-bezier(0.25,0.46,0.45,0.94) forwards; 
}

#card h1 {
    color:#b80050;
    font-family:'Playfair Display', serif;
    font-size:45px;
    margin:10px 0 20px 0;
    font-weight:700;
    text-shadow: 2px 2px 3px rgba(0,0,0,0.2);
    animation: titlePulse 2.5s infinite ease-in-out;
}

@keyframes titlePulse {
    0% {transform:scale(1);}
    50% {transform:scale(1.01);}
    100% {transform:scale(1);}
}

#card p {
    font-size:18px;
    color:#111;
    line-height:1.6;
    font-family:'Quicksand', sans-serif;
    font-weight:500;
    text-align:center;
    width:90%;
    margin:0 auto;
    word-wrap: break-word;
    overflow-wrap: break-word;
}

#card p strong {
    color:#ff3385;
    font-weight:700;
}

.signature {
    margin-top:30px;
    font-family:'Playfair Display', serif;
    font-size:28px;
    color:#b80050;
    font-weight:700;
    text-align:center;
    text-shadow:1px 1px 2px rgba(0,0,0,0.15);
}

.line {
    opacity:0;
    transform: translateY(15px);
    display:block;
    margin-bottom:12px;
    text-align:center;
}

.line.show {
    animation: lineUp 1s cubic-bezier(0.25,0.46,0.45,0.94) forwards;
}

@keyframes lineUp {
    to {opacity:1; transform:translateY(0);}
}

/* --- Decorations --- */
.deco-flower {
    position: absolute;
    font-size: 25px;
    color: #ff80ab;
    z-index: 2;
    opacity: 0;
    animation: decoAppear 2s ease-out forwards;
}

@keyframes decoAppear {
    0% { opacity: 0; transform: scale(0.5) rotate(0deg); }
    50% { opacity: 1; transform: scale(1.1) rotate(15deg); }
    100% { opacity: 1; transform: scale(1) rotate(10deg); }
}

#deco-tl { top: 10px; left: 10px; animation-delay: 1.0s; }
#deco-tr { top: 10px; right: 10px; animation-delay: 1.2s; }
#deco-bl { bottom: 10px; left: 10px; animation-delay: 1.4s; }
#deco-br { bottom: 10px; right: 10px; animation-delay: 1.6s; }

/* --- Falling effects --- */
.falling-heart {
    position: fixed;
    top: -10px;
    pointer-events:none;
    animation: fall 6s linear forwards; 
    z-index:1;
    opacity:0.8;
}

@keyframes fall {
    0% {transform:translateY(0) rotate(0deg); opacity:0.8;}
    100% {transform:translateY(110vh) rotate(360deg); opacity:0;}
}

.click-heart {
    position: fixed;
    animation: floatUp 1.5s ease-out forwards;
    font-size:28px;
    pointer-events:none;
}

@keyframes floatUp {
    0% {transform:translateY(0) scale(1); opacity:1;}
    100% {transform:translateY(-100px) scale(2); opacity:0;}
}

.confetti {
    position: fixed;
    width: 6px;
    height: 6px;
    border-radius:50%;
    opacity:0.9;
    animation: confetti-fall 3s ease-out forwards;
    z-index:20;
}

@keyframes confetti-fall {
    0% {transform:translateY(0) rotate(0); opacity:1;}
    100% {transform:translateY(100vh) rotate(720deg); opacity:0;}
}

/* --- Mobile optimizations --- */
@media(max-width:600px){
    #card {border-radius:15px; border:8px solid #fce4ec; padding:25px 15px; width:95%; background-image:none;}
    #card::before {top:15px; left:15px; right:15px; bottom:15px;}
    #gift-box {width:250px;}
    #note {font-size:16px;}
    #card h1 {font-size:30px; margin-bottom:15px;}
    #card p {font-size:14px; width:100%;}
    .signature {font-size:20px; margin-top:20px;}
    .line {margin-bottom:8px;}
}
</style>
</head>
<body>

<div id="name-input-container">
  <div id="input-wrapper">
      <input type="text" id="recipient-name" placeholder="Nh·∫≠p t√™n">
  </div>
  <button id="start-btn">üéÅ Nh·∫≠n qu√†</button>
</div>

<img id="gift-box" src="1.jpg" alt="H·ªôp qu√†">
<div id="note">üí¨ Nh·∫•n v√†o h·ªôp qu√† ƒë·ªÉ m·ªü nh√© üíñ</div>

<div id="card">
  <div class="deco-flower" id="deco-tl">üå∏</div>
  <div class="deco-flower" id="deco-tr">üå∏</div>
  <div class="deco-flower" id="deco-bl">üå∏</div>
  <div class="deco-flower" id="deco-br">üå∏</div>
  
  <div class="card-main-icon">‚ù§Ô∏è</div>
  <h1>üå∑üíñ Ch√∫c M·ª´ng 20/10 üíêüå∏</h1>
  <p>
    <span class="line">Th√¢n g·ª≠i [name]</span>
    <span class="line">T·∫∑ng nh·ªØng b√¥ng hoa r·ª±c r·ª° nh·∫•t cho nh·ªØng ng∆∞·ªùi ph·ª• n·ªØ tuy·ªát v·ªùi nh·∫•t! üíêüå∑</span>
    <span class="line">üåπ Nh√¢n ng√†y 20/10, t·∫≠p th·ªÉ nam sinh xin g·ª≠i nh·ªØng l·ªùi ch√∫c t∆∞∆°i ƒë·∫πp v√† t·ªët l√†nh nh·∫•t t·ªõi [name]</span>
    <span class="line">üå∏ Ch√∫c [name] lu√¥n vui v·∫ª, kh·ªèe m·∫°nh, m√£i m√£i tr·∫ª trung üå∏</span>
    <span class="line">‚ú® Ch√∫c c√°c b·∫°n n·ªØ - nh·ªØng b√¥ng hoa r·ª±c r·ª° c·ªßa 12A11, lu√¥n xinh ƒë·∫πp, h·ªçc t·∫≠p th√†nh c√¥ng, v√† th·∫≠t h·∫°nh ph√∫c trong m·ªçi kho·∫£nh kh·∫Øc.</span>
    <span class="line">üíï C·∫£m ∆°n c√°c b·∫°n ƒë√£ t·∫°o n√™n nh·ªØng k·ª∑ ni·ªám ƒë√°ng nh·ªõ v√† t√¥ th√™m m√†u r·ª±c r·ª° cho qu√£ng th·ªùi gian c·∫•p 3 n√†y.</span>
    <span class="line">üíê Ch√∫c [name] v√† c√°c b·∫°n c√≥ m·ªôt ng√†y 20/10 th·∫≠t √Ω nghƒ©a v√† ng·∫≠p tr√†n ni·ªÅm vui b√™n nh·ªØng ng∆∞·ªùi th√¢n y√™u!</span>
    <span class="line">Tr√¢n tr·ªçng v√† y√™u qu√Ω!</span>
  </p>
  <div class="signature">T·∫≠p th·ªÉ nam sinh 12A11 g·ª≠i t·∫∑ng</div>
</div>

<script>
const giftBox = document.getElementById('gift-box');
const card = document.getElementById('card');
const note = document.getElementById('note');
const lines = document.querySelectorAll('.line');
const nameInputContainer = document.getElementById('name-input-container');
const recipientNameInput = document.getElementById('recipient-name');
const startBtn = document.getElementById('start-btn');

// M·ªöI: K√≠ch ho·∫°t hi·ªáu ·ª©ng fade-in cho body khi trang ƒë∆∞·ª£c t·∫£i xong
document.addEventListener('DOMContentLoaded', () => {
    document.body.classList.add('fade-in');
});

// X√°c ƒë·ªãnh thi·∫øt b·ªã di ƒë·ªông
const isMobile = window.innerWidth <= 600;

// L·∫§Y T√äN T·ª™ URL (n·∫øu c√≥, t·ª´ trang tr∆∞·ªõc chuy·ªÉn sang)
function getUrlParam(name) {
    const urlParams = new URLSearchParams(window.location.search);
    return urlParams.get(name);
}

const initialRecipientName = getUrlParam('name');
if(initialRecipientName) {
    // N·∫øu c√≥ t√™n, t·ª± ƒë·ªông ƒëi·ªÅn v√†o input v√† ·∫©n n√≥ ƒëi
    recipientNameInput.value = initialRecipientName;
    
    // T·ª∞ ƒê·ªòNG K√çCH HO·∫†T QU√Å TR√åNH CHUY·ªÇN ƒê·ªîI (ƒë·ªÉ b·ªè qua vi·ªác nh·∫•n n√∫t)
    // C·∫ßn 1 ch√∫t delay ƒë·ªÉ ƒë·∫£m b·∫£o hi·ªáu ·ª©ng fade-in c·ªßa body ƒë√£ xong
    setTimeout(() => {
        startBtn.click(); // Gi·∫£ l·∫≠p click n√∫t ƒë·ªÉ ch·∫°y logic ch√≠nh
    }, 700); 
}


// Khi nh·∫•n n√∫t "Nh·∫≠n qu√†"
startBtn.addEventListener('click', () => {
    const name = recipientNameInput.value.trim();
    if(name === "") {
        alert("Vui l√≤ng nh·∫≠p t√™n ng∆∞·ªùi nh·∫≠n! üíñ");
        return;
    }

    // 1. Thay [name] trong c√°c d√≤ng ch√∫c ngay l·∫≠p t·ª©c
    lines.forEach(line=>{
        line.innerHTML = line.innerHTML.replace(/\[name\]/g, `<strong>${name}</strong>`); // S·ª¨A: BOLD T√äN NG∆Ø·ªúI NH·∫¨N
    });

    // 2. B·∫ÆT ƒê·∫¶U HI·ªÜU ·ª®NG FADE-OUT CHO INPUT CONTAINER
    nameInputContainer.classList.add("fade-out-name");

    // ƒê·ª£i hi·ªáu ·ª©ng fade-out k·∫øt th√∫c (0.5s)
    setTimeout(() => {
        nameInputContainer.style.display = "none";
        
        // 3. CHU·∫®N B·ªä V√Ä B·∫ÆT ƒê·∫¶U HI·ªÜU ·ª®NG FADE-IN CHO H·ªòP QU√Ä
        giftBox.style.display = "block";
        
        setTimeout(() => {
            giftBox.classList.add("fade-in-gift");
        }, 10);

        note.textContent = `üí¨ Nh·∫•n v√†o h·ªôp qu√† ƒë·ªÉ m·ªü, ${name} üíñ`;
        
    }, 500);
});

// Khi nh·∫•n h·ªôp qu√†
giftBox.addEventListener('click', () => {
    note.style.display = "none";
    giftBox.src = "2.png";
    giftBox.style.cursor = "default";

    const numConfetti = isMobile ? 2 : 5;
    for(let i=0;i<numConfetti;i++){
        const conf=document.createElement("div");
        conf.classList.add("confetti");
        conf.style.left=Math.random()*100+"vw";
        conf.style.backgroundColor=["#ff4da6","#ffb6c1","#ffd700","#66ccff","#ff66ff"][Math.floor(Math.random()*5)];
        conf.style.width=isMobile ? Math.random()*3+2+"px" : Math.random()*5+3+"px";
        conf.style.height=isMobile ? Math.random()*3+2+"px" : Math.random()*5+3+"px";
        conf.style.animationDuration=isMobile ? 2+Math.random()*0.5+"s" : 2+Math.random()*1+"s";
        document.body.appendChild(conf);
        setTimeout(()=>conf.remove(),2500);
    }

    giftBox.classList.add("fade-out");

    setTimeout(()=>{
        giftBox.style.display="none";
        card.classList.add("show");
        const initialLineDelay = 500;
        lines.forEach((line,i)=>{ 
            setTimeout(()=>line.classList.add('show'), initialLineDelay + i*400); 
        });
    },800);
});

// Hi·ªáu ·ª©ng r∆°i n·ªÅn
function startBackgroundEffects(isMobile) {
    const backgroundIcons = ['üíñ', 'üå∏', '‚ú®'];
    const interval = isMobile ? 3000 : 1500; 
    
    setInterval(() => {
        const iconIndex = Math.floor(Math.random() * backgroundIcons.length);
        const iconChar = backgroundIcons[iconIndex];

        const effect = document.createElement("div");
        effect.textContent = iconChar;
        effect.style.left = Math.random() * 100 + "vw";
        effect.classList.add("falling-heart"); 
        effect.style.fontSize = (isMobile ? Math.random() * 4 + 10 : Math.random() * 6 + 12) + "px"; 
        document.body.appendChild(effect);
        setTimeout(() => effect.remove(), 6000); 
    }, interval);
}

startBackgroundEffects(isMobile);

// Tim bay khi click
document.addEventListener("click", e => {
    const heart = document.createElement("div");
    heart.textContent = "üíó";
    heart.className = "click-heart";
    heart.style.left = e.clientX + "px";
    heart.style.top = e.clientY + "px";
    document.body.appendChild(heart);
    setTimeout(()=>heart.remove(),1000);
});
</script>

</body>
</html>
